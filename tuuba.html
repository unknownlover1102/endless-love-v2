<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Tuuba Paneli</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // Senin Firebase yapƒ±landƒ±rman
    const firebaseConfig = {
      apiKey: "AIzaSyD4RumRC4GnOlSTMONGJcAij9-_64LdBGs",
      authDomain: "endless-love-f201c.firebaseapp.com",
      projectId: "endless-love-f201c",
      storageBucket: "endless-love-f201c.firebasestorage.app",
      messagingSenderId: "144384066384",
      appId: "1:144384066384:web:b583d194fba60954fee255"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Firestore kayƒ±t fonksiyonlarƒ±
    async function saveEntry(type, text) {
      try {
        await addDoc(collection(db, type), {
          text,
          createdAt: serverTimestamp()
        });
      } catch (e) {
        console.error("Firestore hatasƒ±:", e);
      }
    }

    // G√ºnl√ºk kaydetme
    window.saveJournal = async function () {
      const input = document.getElementById("journalInput");
      if (input.value.trim() !== "") {
        await saveEntry("journal", input.value.trim());
        input.value = "";
      }
    };

    // Tahmin kaydetme
    window.saveGuess = async function () {
      const input = document.getElementById("guessInput");
      if (input.value.trim() !== "") {
        await saveEntry("guesses", input.value.trim());
        input.value = "";
      }
    };

    // G√ºnl√ºkleri canlƒ± g√∂ster
    const journalBox = document.getElementById("journalBox");
    const q = query(collection(db, "journal"), orderBy("createdAt", "desc"));
    onSnapshot(q, (snapshot) => {
      journalBox.innerHTML = "";
      snapshot.forEach((doc) => {
        const p = document.createElement("p");
        p.textContent = "üìì " + doc.data().text;
        journalBox.appendChild(p);
      });
    });

    // Tahminleri canlƒ± g√∂ster
    const guessBox = document.getElementById("guessBox");
    const q2 = query(collection(db, "guesses"), orderBy("createdAt", "desc"));
    onSnapshot(q2, (snapshot) => {
      guessBox.innerHTML = "";
      snapshot.forEach((doc) => {
        const p = document.createElement("p");
        p.textContent = "üí° " + doc.data().text;
        guessBox.appendChild(p);
      });
    });
  </script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #ffe6f0;
    }
    header {
      background: #ff4d6d;
      color: white;
      padding: 15px;
      text-align: center;
      position: relative;
    }
    .menu-btn {
      position: absolute;
      left: 10px;
      top: 15px;
      font-size: 22px;
      cursor: pointer;
    }
    nav {
      width: 200px;
      background: #333;
      color: white;
      height: 100%;
      position: fixed;
      left: -200px;
      top: 0;
      transition: 0.3s;
      padding-top: 60px;
    }
    nav a {
      display: block;
      padding: 12px;
      color: white;
      text-decoration: none;
    }
    nav a:hover {
      background: #444;
    }
    .show {
      left: 0;
    }
    section {
      padding: 20px;
    }
    textarea {
      width: 100%;
      height: 100px;
      font-size: 1em;
      padding: 10px;
    }
    button {
      margin-top: 10px;
      padding: 10px 20px;
      background: #ff4d6d;
      border: none;
      color: white;
      cursor: pointer;
      border-radius: 5px;
    }
    button:hover {
      background: #e63950;
    }
    #countdown {
      font-size: 2em;
      margin-top: 20px;
      color: #333;
    }
  </style>
</head>
<body>
  <header>
    <span class="menu-btn" onclick="toggleMenu()">‚ò∞</span>
    Tuuba Paneli
  </header>

  <nav id="sideMenu">
    <a href="#sayac">Saya√ß</a>
    <a href="#gunluk">G√ºnl√ºk</a>
    <a href="#tahmin">G√∂rsel Tahmin</a>
  </nav>

  <!-- Saya√ß -->
  <section id="sayac">
    <h2>‚è≥ Geri Sayƒ±m</h2>
    <div id="countdown"></div>
  </section>

  <!-- G√ºnl√ºk -->
  <section id="gunluk">
    <h2>üìñ G√ºnl√ºk</h2>
    <p>‚ÄúG√ºn√ºm√ºz√º birbirimize anlatalƒ±m, tamam ayrƒ±yƒ±z bana deƒüil buraya anlat ben bakmam.‚Äù</p>
    <textarea id="journalInput" placeholder="G√ºnl√ºƒü√ºn√º buraya yaz..."></textarea>
    <button onclick="saveJournal()">Kaydet</button>
    <div id="journalBox"></div>
  </section>

  <!-- G√∂rsel Tahmin -->
  <section id="tahmin">
    <h2>üñºÔ∏è G√∂rsel Tahmin</h2>
    <img src="resim1.jpg" alt="Tahmin" width="200">
    <p>Bu fotoƒüraf sana ne hissettiriyor?</p>
    <textarea id="guessInput" placeholder="Tahminini buraya yaz..."></textarea>
    <button onclick="saveGuess()">Kaydet</button>
    <div id="guessBox"></div>
  </section>

  <script>
    function toggleMenu() {
      document.getElementById("sideMenu").classList.toggle("show");
    }

    // Saya√ß (ba≈ülangƒ±√ß: 6 Aƒüustos 2025, s√ºre: 40 g√ºn)
    const startDate = new Date("2025-08-06T00:00:00").getTime();
    const duration = 40 * 24 * 60 * 60 * 1000;
    const endDate = startDate + duration;

    function updateCountdown() {
      const now = new Date().getTime();
      const remaining = endDate - now;

      if (remaining < 0) {
        document.getElementById("countdown").innerText = "Bitti!";
        return;
      }

      const days = Math.floor(remaining / (1000 * 60 * 60 * 24));
      const hours = Math.floor((remaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((remaining % (1000 * 60)) / 1000);

      document.getElementById("countdown").innerText =
        `${days}g ${hours}s ${minutes}d ${seconds}sn`;
    }

    setInterval(updateCountdown, 1000);
  </script>
</body>
</html>
